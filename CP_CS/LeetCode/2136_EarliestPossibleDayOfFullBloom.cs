using NUnit.Framework;

namespace CP_CS.LeetCode;

public class EarliestPossibleDayOfFullBloom {
    public int EarliestFullBloom(int[] plantTime, int[] growTime)
    {
        int n = plantTime.Length;
        int days = 0;

        PriorityQueue<int, int> queue = new PriorityQueue<int, int>();
        List<int> growing = new();

        for (int i = 0; i < n; i++)
        {
            int cost = plantTime[i] + growTime[i];
            queue.Enqueue(i, -cost);
        }

        while (queue.Count > 0 || growing.Any())
        {
            for (int i = 0; i < growing.Count; i++)
            {
                int index = growing[i];
                //Console.WriteLine($"    Day {days} - Plant {index} goes from {growTime[index]} to {growTime[index] - 1} days of growing");
                growTime[index]--;
                if (growTime[index] != 0) continue;
                
                growing.RemoveAt(i);
                i--;
            }

            if (queue.Count > 0)
            {
                int index = queue.Dequeue();
                //Console.WriteLine($"Day {days} - Plant {index} goes from {plantTime[index]} to {plantTime[index] - 1} days of planting");
                plantTime[index]--;

                if (plantTime[index] == 0)
                {
                    growing.Add(index);
                }
                else
                {
                    int cost = plantTime[index] + growTime[index];
                    queue.Enqueue(index, -cost);
                }
            }

            days++;
        }

        return days;
    }
    
    [Test]
    public void _1494Test5()
    {
        int[] arr1 =
        {
            6089, 6945, 1935, 99, 1762, 464, 8239, 2288, 1781, 7671, 7629, 8749, 5494, 4351, 5873, 7921, 6626, 7680,
            6925, 7819, 1221, 4293, 1038, 7039, 6637, 84, 7503, 6639, 7203, 3141, 8237, 8638, 8401, 1323, 728, 6194,
            415, 6680, 6453, 8398, 2186, 5779, 3508, 8871, 1498, 5938, 5947, 4009, 2294, 6483, 6609, 1289, 590, 5178,
            1862, 356, 3644, 939, 5131, 2872, 4820, 3102, 5885, 3336, 8050, 766, 2405, 2296, 4183, 8735, 6254, 6107,
            3222, 5996, 5943, 1313, 1653, 397, 5842, 5598, 2664, 1590, 7228, 1560, 7136, 6623, 2962, 3318, 5563, 999,
            5394, 7316, 1084, 8611, 7058, 7490, 3292, 6965, 3878, 3384, 2039, 8940, 2650, 238, 1996, 1211, 4685, 6491,
            4681, 6523, 2665, 4471, 313, 533, 235, 1146, 6770, 3355, 8912, 7441, 2732, 5205, 2134, 5310, 1186, 8207,
            3870, 6741, 6492, 6129, 7755, 3307, 2390, 772, 2498, 6165, 1834, 5485, 8767, 2801, 2824, 7426, 372, 5966,
            2591, 8807, 8971, 3198, 423, 2819, 7898, 1433, 8569, 8836, 2194, 946, 403, 5698, 6409, 6840, 39, 6967, 7595,
            2611, 577, 1254, 5999, 6031, 1824, 3781, 8546, 7652, 6332, 7334, 805, 4441, 3655, 4110, 2629, 5699, 3496,
            5407, 7728, 6514, 7734, 6012, 2210, 2465, 3237, 8089, 2751, 7301, 5571, 6337, 4947, 190, 773, 5266, 4888,
            5398, 7981, 6200, 2240, 7440, 3211, 1079, 3450, 256, 635, 5798, 1829, 8137, 6428, 7818, 2566, 3864, 5230,
            1234, 8157, 1792, 3912, 6899, 5261, 8711, 3379, 5154, 4277, 7262, 4290, 8849, 2894, 2955, 1781, 2790, 3072,
            803, 562, 6014, 293, 1362, 7301, 5222, 633, 8827, 1331, 2031, 3064, 7139, 7670, 3874, 2257, 1329, 4784,
            2108, 4698, 578, 3727, 6061, 6808, 4710, 8548, 2633, 3985, 6910, 7835, 6833, 2480, 6, 4519, 6691, 1727,
            5383, 4121, 1853, 2490, 1706, 1415, 7608, 7917, 7025, 8894, 6661, 5465, 1339, 6491, 8222, 5756, 2172, 3376,
            8742, 798, 322, 6298, 6796, 8558, 3278, 7509, 8093, 1143, 8037, 1742, 8655, 8109, 8378, 3848, 7229, 5071,
            7229, 4811, 6398, 4142, 1982, 489, 2226, 1045, 5640, 8933, 4970, 160, 5164, 3249, 7751, 6192, 5050, 3372,
            7857, 3542, 593, 4099, 1663, 1566, 5157, 8003, 3206, 3509, 8063, 7000, 863, 587, 7695, 8208, 4692, 8632,
            4703, 124, 6597, 3299, 1086, 2337, 5931, 2618, 3127, 5678, 6361, 7717, 2912, 4366, 6699, 5125, 1111, 2692,
            8731, 6958, 2123, 8642, 987, 2702, 5839, 3695, 3435, 5707, 2408, 7375, 308, 6111, 7123, 7179, 6022, 4472,
            7863, 4766, 7468, 2787, 4694, 7709, 111, 8765, 586, 6125, 7405, 5148, 3462, 5375, 2114, 735, 400, 1097,
            6264, 5467, 2878, 8993, 2143, 1667, 5172, 4957, 2641, 800, 1476, 5789, 3233, 8875, 4462, 8389, 6060, 7013,
            4844, 7525, 7718, 3098, 3561, 8506, 3740, 549, 7289, 3189, 3215, 2350, 5602, 4042, 5590, 89, 2266, 854,
            8497, 4904, 6693, 3948, 8008, 333, 6863, 3505, 5576, 3120, 3696, 1871, 929, 6494, 3217, 6275, 6932, 2534,
            2369, 6709, 8698, 7850, 3433, 913, 1909, 1215, 1980, 2910, 8840, 3732, 5512, 2982, 8260, 6513, 143, 3783,
            3266, 6524, 3957, 4520, 3114, 5442, 8786, 6115, 3994, 8704, 2314, 2868, 2602, 3392, 8255, 3414, 7586, 5151,
            1970, 3015, 2340, 8, 1485, 396, 7973, 2645, 1553, 284, 7751, 2179, 5881, 867, 3073, 3155, 5994, 6148, 652,
            8822, 1483, 692, 5134, 8573, 1976, 7537, 2021, 7900, 6890, 65, 3948, 3827, 4666, 1469, 7318, 2489, 5566,
            3945, 7626, 7539, 5846, 5599, 5785, 529, 5164, 1054, 3218, 1881, 8751, 2967, 4201, 5527, 7667, 238, 2693,
            5378, 7864, 3608, 2843, 1012, 3657, 7511, 1706, 452, 7199, 6117, 5827, 797, 51, 6126, 8427, 2662, 1464,
            8371, 3018, 8954, 6666, 3099, 5781, 4596, 5253, 8991, 5369, 1755, 6928, 7367, 890, 4539, 5829, 783, 1435,
            5925, 2751, 6991, 6689, 2075, 3569, 5283, 1911, 8450, 1020, 4588, 6920, 3038, 7961, 1576, 1352, 3595, 5474,
            3199, 2868, 3900, 3744, 1474, 4314, 1601, 4113, 6024, 1017, 2187, 8016, 3998, 193, 7279, 4826, 540, 2623,
            1076, 4944, 415, 4534, 245, 1413, 3397, 6166, 2219, 3432, 8107, 4238, 1117, 4937, 6570, 8621, 5500, 7303,
            7826, 4813, 5459, 6630, 7453, 1900, 3332, 6703, 3250, 3314, 5336, 4869, 2771, 2427, 5444, 3743, 540, 7947,
            3483, 4611, 1889, 8560, 7914, 5626, 640, 248, 7042, 4096, 2719, 6899, 5155, 137, 3819, 7642, 6385, 5245,
            2107, 2456, 5263, 804, 548, 345, 8770, 4467, 4831, 3919, 7389, 481, 7786, 8004, 2844, 2866, 7421, 7091,
            3129, 2363, 6573, 1451, 862, 2130, 5192, 8051, 6235, 6118, 1861, 1252, 689, 5711, 1498, 7781, 62, 3161,
            5567, 3468, 8634, 2788, 3029, 852, 6750, 1483, 3683, 399, 2890, 7992, 7323, 2946, 220, 2145, 634, 3139,
            5259, 5076, 6324, 7966, 6956, 2823, 8181, 1294, 2176, 139, 2426, 2307
        };
        int[] arr2 =
        {
            3285, 5607, 4315, 2919, 6989, 2289, 309, 7113, 1748, 3416, 1499, 1747, 4355, 2700, 5317, 4209, 726, 4647,
            1712, 5176, 8614, 6499, 8102, 7892, 4136, 2961, 5757, 4293, 8167, 5123, 2994, 8734, 8996, 4038, 3495, 1799,
            3898, 1437, 8458, 3414, 7688, 5103, 5286, 1514, 7132, 3550, 3050, 6955, 6980, 5202, 6455, 8167, 5868, 7558,
            8436, 2808, 7742, 7388, 3707, 5806, 7388, 8198, 2436, 4871, 3295, 2396, 2435, 945, 2366, 5295, 1137, 3362,
            6872, 4685, 3360, 6928, 1172, 7579, 5722, 3811, 2450, 6434, 141, 3636, 6118, 5113, 4167, 2644, 1094, 2023,
            8184, 2440, 2387, 7368, 3381, 4759, 803, 684, 6340, 716, 2687, 3427, 1157, 561, 2798, 8159, 1004, 261, 4781,
            338, 1330, 7371, 679, 5582, 8983, 6608, 8775, 6899, 8506, 1641, 6203, 4671, 68, 5254, 4915, 2365, 7679,
            1935, 6262, 1548, 6025, 2100, 7535, 7312, 7600, 8953, 8886, 3403, 6443, 3701, 8112, 7458, 2745, 5199, 1831,
            1557, 8284, 2030, 8305, 3222, 687, 8536, 5607, 2263, 5263, 3626, 4591, 8015, 6275, 7009, 5287, 2255, 7430,
            6018, 2577, 6, 3115, 8491, 4241, 4061, 163, 7257, 1990, 3040, 491, 8050, 5643, 8904, 2742, 7109, 2742, 813,
            8400, 4770, 6124, 3891, 495, 5438, 8924, 5298, 3187, 3013, 8373, 5881, 1966, 8033, 999, 801, 2320, 3081,
            1499, 975, 6811, 4303, 6734, 3548, 2401, 8541, 1542, 6490, 2574, 2582, 3488, 8579, 3384, 8487, 3733, 2879,
            4616, 5283, 4257, 3445, 5279, 1217, 83, 8192, 5171, 629, 6255, 5330, 8866, 1522, 7298, 8595, 76, 3863, 4969,
            2970, 2493, 8933, 1335, 2905, 8892, 7464, 4276, 6449, 2657, 8181, 7124, 1571, 2990, 1295, 46, 2296, 1077,
            5833, 6786, 7809, 957, 7144, 154, 2855, 2109, 2128, 2885, 5701, 458, 2071, 2249, 6602, 3726, 2771, 787,
            4603, 3154, 4463, 7121, 8434, 2694, 3286, 734, 2339, 6402, 4375, 6591, 3268, 514, 2347, 939, 101, 5334,
            6240, 228, 524, 8445, 1234, 2565, 4341, 8444, 2179, 1019, 3912, 5288, 6943, 2068, 4549, 7423, 5439, 5469,
            7986, 4711, 1606, 2834, 5736, 8856, 3504, 6929, 8395, 115, 5940, 4373, 1975, 5199, 8206, 3929, 3292, 1655,
            98, 643, 2863, 4923, 7119, 8869, 7021, 6521, 7567, 8814, 2376, 7787, 8703, 766, 1329, 1431, 3287, 3692,
            2818, 2691, 8075, 3164, 3030, 7635, 2123, 559, 8256, 2608, 6284, 2799, 7470, 67, 6882, 929, 6975, 8765,
            7581, 1518, 1827, 2972, 2665, 6105, 3028, 1782, 7793, 7752, 8040, 3912, 7786, 1962, 191, 7566, 2716, 4452,
            7828, 2383, 6626, 1744, 7329, 1838, 2918, 3587, 2825, 5554, 6845, 327, 3163, 3151, 2460, 8961, 5509, 2718,
            8134, 6256, 47, 1505, 6770, 931, 3755, 58, 8055, 3038, 4195, 6332, 6061, 5556, 681, 451, 8924, 2641, 4521,
            2182, 1436, 7210, 3579, 4501, 178, 1479, 2349, 8508, 5607, 2188, 344, 1883, 5623, 2654, 2617, 8051, 8172,
            4385, 4654, 2881, 712, 4674, 3014, 7054, 3077, 5432, 4339, 2154, 8868, 1031, 8915, 1854, 2237, 2930, 3702,
            5626, 1556, 1424, 6360, 102, 7547, 774, 390, 6413, 5745, 419, 1883, 6422, 7642, 786, 1849, 7916, 4203, 1959,
            526, 5436, 1277, 3281, 4922, 5284, 2148, 3257, 7370, 892, 8066, 2052, 1334, 6157, 8443, 4754, 5973, 6027,
            1081, 3527, 8939, 4311, 7158, 3218, 5028, 2249, 665, 1993, 2553, 6107, 1116, 2984, 6453, 944, 5564, 6219,
            4618, 1038, 1340, 8726, 8705, 1367, 2926, 5118, 3475, 7588, 1203, 6012, 6879, 6610, 846, 4746, 4018, 1953,
            649, 1296, 1588, 3257, 2428, 3538, 5970, 3206, 4996, 5339, 6932, 6771, 7351, 4325, 8733, 6628, 5301, 1319,
            1805, 1765, 2418, 6520, 996, 4619, 4547, 3180, 1519, 3537, 3035, 5927, 4321, 6383, 3324, 5849, 818, 307,
            6456, 6460, 7415, 6302, 1676, 8472, 2334, 8060, 2288, 4398, 3588, 3207, 3809, 3619, 3009, 2888, 3339, 5051,
            6858, 4079, 5857, 8525, 3934, 2138, 2736, 1580, 1985, 37, 6807, 8193, 1939, 1857, 2550, 5853, 8589, 6898,
            1145, 2789, 7107, 6195, 330, 7068, 6301, 5599, 3666, 385, 7897, 5578, 6541, 4653, 1269, 7535, 5789, 2893,
            4298, 5788, 2264, 7318, 14, 2079, 5536, 340, 3041, 616, 4567, 7222, 5100, 7634, 2206, 3619, 6110, 7445,
            1317, 2680, 2257, 5845, 5109, 916, 1162, 4574, 6657, 8935, 2420, 763, 1124, 362, 53, 4611, 5395, 4559, 8484,
            2000, 2985, 5599, 4118, 4779, 6805, 610, 2384, 4142, 3196, 8938, 4025, 4933, 422, 3681, 7075, 1490, 1274,
            1997, 6771, 2298, 7147, 8107, 5301, 3823, 2769, 3376, 1869, 32, 5659, 8117, 563, 2636, 7384, 4735, 8119,
            1262, 7741, 5038, 71, 3728, 6484, 2150, 737, 1145, 5511, 7218, 4606, 1924, 4701, 550, 6442, 4090, 7819,
            6030, 7770, 7275, 8887, 697, 541, 1194, 4349, 8519, 3858, 1657, 1048, 8601, 6875, 2313, 6172, 2628, 2468,
            5827, 6708, 5538, 6982, 5695, 1502, 5758, 5296
        };

        Console.WriteLine(EarliestFullBloom(arr1, arr2));
    }
}